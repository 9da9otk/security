/* ===================== أساسيات عامة ===================== */
:root{
  --bg:#0b1220;          /* خلفية داكنة للمدخلات/البطاقات */
  --bg-2:#111827;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --brand:#0ea5e9;       /* أزرق رئيسي */
  --ok:#10b981;          /* أخضر */
  --warn:#f59e0b;        /* برتقالي */
  --danger:#ef4444;      /* أحمر */
  --violet:#7c3aed;      /* بنفسجي */
  --violet-200:#c084fc;
  --card-shadow:0 10px 25px rgba(0,0,0,.18);
  --radius:16px;
}

*{box-sizing:border-box}
html,body{height:100%;margin:0;padding:0}
body{
  font-family:"Tajawal","Cairo",ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  color:var(--text);
  background:#0f172a;
  overflow:hidden; /* الخريطة بملء الشاشة */
}
a{color:var(--brand)}
.hidden{display:none!important}

/* ===================== الخريطة ===================== */
#map{
  position:fixed; inset:0; width:100%; height:100vh;
}
@supports(height:100svh){ #map{ height:100svh } }

/* عناصرنا فوق عناصر Google */
.sidebar,.mobile-toggle,.add-hint,.layers-toggle,.layers-panel,.backdrop{
  position:fixed; z-index:1001;
}

/* ===================== لوحة التحرير ===================== */
.sidebar{
  top:24px; right:24px;
  width:420px; max-width:92vw;
  background:linear-gradient(180deg,rgba(17,24,39,.94),rgba(11,18,32,.97));
  backdrop-filter:blur(10px);
  border:1px solid rgba(255,255,255,.06);
  border-radius:var(--radius);
  box-shadow:var(--card-shadow);
  padding:20px;

  /* تمرير داخلي */
  max-height:calc(100vh - 48px);
  overflow-y:auto;
  scrollbar-gutter:stable both-edges;
}
.sidebar h3{margin:0 0 14px;font-size:22px;font-weight:800;letter-spacing:.3px}

.panel{
  background:rgba(17,24,39,.6);
  border:1px solid rgba(255,255,255,.06);
  border-radius:14px;
  padding:14px; margin-bottom:14px;
}
.panel-header{display:flex;align-items:center;justify-content:space-between;margin:-6px 0 10px}
.icon-btn{border:0;background:transparent;color:var(--muted);font-size:22px;line-height:1;cursor:pointer}
.icon-btn:hover{color:#fff}

label{display:block;font-size:13px;color:var(--muted);margin:10px 0 6px}
input[type="text"],input[type="number"],textarea{
  width:100%; background:var(--bg); color:var(--text);
  border:1px solid rgba(255,255,255,.08); border-radius:10px;
  padding:12px 14px; outline:none; transition:.15s border,.15s box-shadow; box-shadow:none;
}
textarea{resize:vertical}
input[type="text"]:focus,input[type="number"]:focus,textarea:focus{
  border-color:rgba(14,165,233,.6); box-shadow:0 0 0 3px rgba(14,165,233,.12);
}
input[type="color"]{width:100%;height:38px;border:1px solid rgba(255,255,255,.08);border-radius:10px;background:var(--bg);padding:2px}
input[type="range"]{width:100%;accent-color:var(--violet)}

.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.chk{display:flex;gap:8px;align-items:center;font-size:14px;color:#cbd5e1}
.chk input{transform:scale(1.1)}

.btn{
  width:100%; display:inline-flex; align-items:center; justify-content:center; gap:8px;
  background:var(--bg); color:#e5e7eb;
  border:1px solid rgba(255,255,255,.10);
  border-radius:12px; padding:12px 14px; cursor:pointer;
  transition:.2s background,.2s transform,.2s border,.2s filter;
}
.btn:hover{background:#141b2d}
.btn:active{transform:translateY(1px)}
.btn[disabled]{opacity:.5;cursor:not-allowed}

.btn-primary{background:linear-gradient(90deg,#059669,#10b981);border:none;color:#fff;font-weight:700}
.btn-primary:hover{filter:brightness(1.05)}
.btn-dark{background:linear-gradient(90deg,#4c1d95,#7c3aed);border:none;color:#fff;font-weight:700}
.btn-danger{background:linear-gradient(90deg,#b91c1c,#ef4444);border:none;color:#fff;font-weight:800}

.hint{margin:10px 0 0;font-size:12px;color:var(--muted)}
#emptyState{text-align:center;color:#e5e7eb;font-size:14px}

/* زر فتح المحرر للجوال */
.mobile-toggle{
  left:16px; bottom:16px;
  background:rgba(17,24,39,.95);
  border:1px solid rgba(255,255,255,.08);
  color:#e5e7eb; padding:14px 18px; border-radius:18px;
  box-shadow:var(--card-shadow); font-weight:800; cursor:pointer;
}
.mobile-toggle:active{transform:translateY(1px)}

/* خلفية عند فتح اللوحة */
.backdrop{inset:0;background:rgba(0,0,0,.4)}
.backdrop.hidden{display:none!important}

/* سلوك الجوال: سحب من اليمين + تمرير */
@media (max-width:1024px){
  .sidebar{
    right:0; top:0; bottom:0; height:100%; max-height:100svh;
    border-radius:0; border-left:1px solid rgba(255,255,255,.08);
    padding:18px; overflow-y:auto; transform:translateX(100%); transition:transform .25s ease;
  }
  .sidebar.open{transform:translateX(0)}
}

/* ===================== تلميح وضع الإضافة ===================== */
.add-hint{
  top:18px; left:50%; transform:translateX(-50%);
  background:rgba(17,24,39,.95);
  border:1px solid rgba(255,255,255,.08);
  color:#e5e7eb; padding:10px 14px; border-radius:12px;
  box-shadow:var(--card-shadow); font-size:14px;
}

/* ===================== لوحة الطبقات ===================== */
.layers-toggle{
  top:16px; left:16px;
  background:rgba(17,24,39,.95);
  border:1px solid rgba(255,255,255,.08);
  color:#e5e7eb; padding:10px 12px; border-radius:12px;
  box-shadow:var(--card-shadow); cursor:pointer;
}
.layers-panel{
  top:64px; left:16px; width:260px; max-width:92vw;
  background:rgba(17,24,39,.95);
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px; box-shadow:var(--card-shadow); padding:10px;
}
.layers-panel .row{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:6px 8px;border-radius:10px}
.layers-panel .row:hover{background:rgba(255,255,255,.04)}
.layers-panel label{margin:0;font-size:14px;color:#d1d5db}
.layers-panel select,.layers-panel input[type="checkbox"]{accent-color:var(--brand)}

/* ===================== كرت معلومات مخصّص (اختياري) ===================== */
.tooltip-card{
  background:#1f2937; color:#f8fafc;
  border:1px solid rgba(255,255,255,.12);
  border-radius:14px; box-shadow:0 16px 40px rgba(0,0,0,.35);
  padding:14px 16px; min-width:240px; max-width:360px;
  line-height:1.7; font-size:16px;
}
.tooltip-card h4{margin:0 0 8px;font-size:18px;font-weight:800;letter-spacing:.2px}
.tooltip-card .label{display:block;color:#cbd5e1;font-size:13px;margin:6px 0 4px}
.tooltip-card .sep{height:1px;background:rgba(255,255,255,.08);margin:10px 0}
.tooltip-card .names{white-space:pre-line;margin:0;color:#e5e7eb;font-size:15px}

/* ===================== تصحيح ثيم Google InfoWindow الافتراضي ===================== */
.gm-style .gm-style-iw-c{
  background:#1f2937 !important;             /* خلفية داكنة */
  color:#f8fafc !important;                   /* نص فاتح */
  border-radius:14px !important;
  padding:0 !important;
  box-shadow:0 16px 40px rgba(0,0,0,.35) !important;
  border:1px solid rgba(255,255,255,.12) !important;
  direction:rtl; text-align:right;
  font-family:"Tajawal","Cairo",system-ui,Arial;
  line-height:1.7; font-size:16px;
}
.gm-style .gm-style-iw-d{ overflow:visible !important; }
.gm-style .gm-style-iw-c h4{ margin:0 0 8px; font-size:18px; font-weight:800 }
.gm-style .gm-style-iw-c .label{ color:#cbd5e1; font-size:13px; margin:6px 0 4px; display:block }
.gm-style .gm-style-iw-c .sep{ height:1px; background:rgba(255,255,255,.08); margin:10px 0 }
.gm-style .gm-style-iw-c .names{ white-space:pre-line; margin:0; color:#e5e7eb; font-size:15px }
.gm-style .gm-style-iw-tc::after{
  background:#1f2937 !important;
  box-shadow:0 10px 24px rgba(0,0,0,.35) !important; /* مثلث المؤشر */
}
/* زر الإغلاق يصبح واضحاً على الخلفية الداكنة */
.gm-style .gm-style-iw-c button.gm-ui-hover-effect{
  filter:invert(1) contrast(1.2);
  right:6px !important; top:6px !important;
}

/* ===================== تصحيحات أخرى لعناصر Google ===================== */
.gm-fullscreen-control,.gm-bundled-control-on-bottom{ margin-bottom:68px } /* لا تغطي أزرارنا */

/* ===================== هوامش آمنة للهواتف ===================== */
@supports(padding-bottom: env(safe-area-inset-bottom)){
  .mobile-toggle{ padding-bottom:calc(14px + env(safe-area-inset-bottom)) }
  .sidebar{ padding-bottom:calc(20px + env(safe-area-inset-bottom)) }
}
