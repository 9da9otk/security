<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>خريطة الأمن – Diriyah</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- شريط تلميح يظهر فقط في وضع العرض (لا أزرار) -->
  <div id="sharebar" class="sharebar hidden">
    <span>وضع العرض (عرض فقط)</span>
  </div>

  <!-- الخريطة -->
  <div id="map" aria-label="الخريطة" role="application"></div>

  <!-- لوحة التحرير (لا تظهر في وضع العرض) -->
  <aside id="panel" class="panel">
    <h3>الطبقات</h3>
    <label class="row"><input id="toggle-markers" type="checkbox" checked /><span>المواقع</span></label>
    <label class="row"><input id="toggle-circles" type="checkbox" checked /><span>دوائر الأمان</span></label>

    <div class="sep"></div>

    <h3>نوع الخريطة</h3>
    <select id="basemap">
      <option value="roadmap">طرق</option>
      <option value="satellite">أقمار</option>
      <option value="hybrid">هجينة</option>
      <option value="terrain">تضاريس</option>
    </select>

    <div class="sep"></div>

    <h3>تحرير الدائرة (المحددة)</h3>
    <div class="row"><span>نصف القطر</span><input id="ed-radius" type="range" min="5" max="200" step="1" value="15" /></div>
    <div class="row"><span>لون التعبئة</span><input id="ed-fill" type="color" value="#60a5fa" /></div>
    <div class="row"><span>شفافية التعبئة</span><input id="ed-fillop" type="range" min="0" max="1" step="0.01" value="0.16" /></div>
    <div class="row"><span>لون الحدود</span><input id="ed-stroke" type="color" value="#60a5fa" /></div>
    <div class="row"><span>سماكة الحدود</span><input id="ed-stroke-w" type="range" min="0" max="6" step="1" value="2" /></div>

    <div class="row" style="justify-content:flex-end; gap:8px; margin-top:8px;">
      <button id="btn-add" class="btn small">إضافة دائرة جديدة</button>
      <button id="btn-del" class="btn ghost small">حذف الدائرة</button>
    </div>

    <div class="sep"></div>

    <button id="share-btn" class="btn">نسخ رابط العرض</button>
    <small class="hint">يشمل المستلمين وخصائص الدوائر والمواقع.</small>
    <div id="toast" class="toast hidden" role="status" aria-live="polite">تم النسخ ✅</div>
  </aside>

  <!-- زر حركة المرور (متاح في الوضعين) -->
  <button id="traffic-toggle" class="floating-btn" aria-pressed="false" title="إظهار/إخفاء حركة المرور">حركة المرور</button>

  <!-- كرت المعلومات -->
  <aside id="info-card" class="card hidden" aria-live="polite">
    <img class="brand" src="img/diriyah-logo.png" alt="Diriyah Company" />
    <button class="close" aria-label="إغلاق">×</button>
    <h3 id="site-name">—</h3>
    <p class="meta"><span id="site-type">—</span></p>
    <div class="row"><div>الإحداثيات</div><div id="site-coord">—</div></div>
    <div class="row"><div>نصف القطر</div><div id="site-radius">—</div></div>
    <div class="row"><div>المستلمون</div><div id="site-recipients">—</div></div>
    <div id="edit-actions" class="actions hidden"><button id="edit-recipients" class="btn small">تعديل المستلمين</button></div>
  </aside>

  <!-- محرر المستلمين -->
  <div id="editor" class="editor hidden" role="dialog" aria-modal="true" aria-labelledby="editor-title">
    <div class="editor-box">
      <h3 id="editor-title">تحرير المستلمين</h3>
      <p class="hint">اكتب اسمًا في كل سطر.</p>
      <textarea id="editor-input" rows="8" spellcheck="false" dir="auto"></textarea>
      <div class="editor-actions"><button id="editor-cancel" class="btn ghost">إلغاء</button><button id="editor-save" class="btn">حفظ</button></div>
    </div>
  </div>

  <noscript>هذه الصفحة تتطلب تفعيل JavaScript لعرض خريطة Google.</noscript>

  <script defer src="js/main.js"></script>
  <!-- ضع مفتاحك بدل XXXXX -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjX9UJKG53r5ymGydlWEMNbuvi234LcC8&v=weekly&callback=initMap"></script>
</body>
</html>
